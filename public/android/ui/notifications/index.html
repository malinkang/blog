<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="é€šçŸ¥ é€šçŸ¥æ˜¯æ‚¨å¯ä»¥åœ¨åº”ç”¨çš„å¸¸è§„ UI å¤–éƒ¨å‘ç”¨æˆ·æ˜¾ç¤ºçš„æ¶ˆæ¯ã€‚å½“æ‚¨å‘ŠçŸ¥ç³»ç»Ÿå‘å‡ºé€šçŸ¥æ—¶ï¼Œå®ƒå°†å…ˆä»¥å›¾æ ‡çš„å½¢å¼æ˜¾ç¤ºåœ¨é€šçŸ¥åŒºåŸŸä¸­ã€‚ç”¨æˆ·å¯ä»¥æ‰“å¼€æŠ½å±‰å¼é€šçŸ¥æ æŸ¥çœ‹é€šçŸ¥çš„è¯¦ç»†ä¿¡æ¯ã€‚ é€šçŸ¥åŒºåŸŸå’ŒæŠ½å±‰å¼é€šçŸ¥æ å‡æ˜¯ç”±ç³»ç»Ÿæ§åˆ¶çš„åŒºåŸŸï¼Œç”¨æˆ·å¯ä»¥éšæ—¶æŸ¥çœ‹ã€‚ åˆ›å»ºé€šçŸ¥ SupportV4åŒ…æä¾›äº† NotificationCompat.Builder ç±»ã€‚Android 3.0ï¼ˆAPI çº§åˆ« 11ï¼‰ä¸­å·²æ·»åŠ ç±» Notification.Builderã€‚ æ‚¨å¯ä»¥åœ¨ NotificationCompat.Builder å¯¹è±¡ä¸­ä¸ºé€šçŸ¥æŒ‡å®š UI ä¿¡æ¯å’Œæ“ä½œã€‚è¦åˆ›å»ºé€šçŸ¥ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder.build()ï¼Œå®ƒå°†è¿”å›åŒ…å«æ‚¨çš„å…·ä½“è§„èŒƒçš„ Notification å¯¹è±¡ã€‚è¦å‘å‡ºé€šçŸ¥ï¼Œè¯·é€šè¿‡è°ƒç”¨ NotificationManager.notify() å°† Notification å¯¹è±¡ä¼ é€’ç»™ç³»ç»Ÿã€‚ å¿…éœ€çš„é€šçŸ¥å†…å®¹ Notification å¯¹è±¡å¿…é¡»åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š å°å›¾æ ‡ï¼Œç”± setSmallIcon() è®¾ç½® æ ‡é¢˜ï¼Œç”± setContentTitle() è®¾ç½® è¯¦ç»†æ–‡æœ¬ï¼Œç”± setContentText() è®¾ç½® å¯é€‰é€šçŸ¥å†…å®¹å’Œè®¾ç½® æ‰€æœ‰å…¶ä»–é€šçŸ¥è®¾ç½®å’Œå†…å®¹éƒ½æ˜¯å¯é€‰çš„ã€‚å¦‚éœ€äº†è§£æœ‰å…³å®ƒä»¬çš„æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜… NotificationCompat.Builder å‚è€ƒæ–‡æ¡£ã€‚ é€šçŸ¥æ“ä½œ å°½ç®¡é€šçŸ¥æ“ä½œéƒ½æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯æ‚¨è‡³å°‘åº”å‘é€šçŸ¥æ·»åŠ ä¸€ä¸ªæ“ä½œã€‚ æ“ä½œå…è®¸ç”¨æˆ·ç›´æ¥ä»é€šçŸ¥è½¬åˆ°åº”ç”¨ä¸­çš„ Activityï¼Œä»–ä»¬å¯åœ¨å…¶ä¸­æŸ¥çœ‹ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶æˆ–æ‰§è¡Œè¿›ä¸€æ­¥çš„æ“ä½œã€‚ ä¸€ä¸ªé€šçŸ¥å¯ä»¥æä¾›å¤šä¸ªæ“ä½œã€‚æ‚¨åº”è¯¥å§‹ç»ˆå®šä¹‰ä¸€ä¸ªå½“ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶ä¼šè§¦å‘çš„æ“ä½œï¼›é€šå¸¸ï¼Œæ­¤æ“ä½œä¼šåœ¨åº”ç”¨ä¸­æ‰“å¼€ Activityã€‚ æ‚¨ä¹Ÿå¯ä»¥å‘é€šçŸ¥æ·»åŠ æŒ‰é’®æ¥æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œä¾‹å¦‚ï¼Œæš‚åœé—¹é“ƒæˆ–ç«‹å³ç­”å¤çŸ­ä¿¡ï¼›æ­¤åŠŸèƒ½è‡ª Android 4.1 èµ·å¯ç”¨ã€‚å¦‚æœä½¿ç”¨å…¶ä»–æ“ä½œæŒ‰é’®ï¼Œåˆ™æ‚¨è¿˜å¿…é¡»ä½¿è¿™äº›æŒ‰é’®çš„åŠŸèƒ½åœ¨åº”ç”¨çš„ Activity ä¸­å¯ç”¨ï¼› åœ¨ Notification å†…éƒ¨ï¼Œæ“ä½œæœ¬èº«ç”± PendingIntent å®šä¹‰ï¼Œåè€…åŒ…å«åœ¨åº”ç”¨ä¸­å¯åŠ¨ Activity çš„ Intentã€‚è¦å°† PendingIntent ä¸æ‰‹åŠ¿ç›¸å…³è”ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder çš„é€‚å½“æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦åœ¨ç”¨æˆ·ç‚¹å‡»æŠ½å±‰å¼é€šçŸ¥æ ä¸­çš„é€šçŸ¥æ–‡æœ¬æ—¶å¯åŠ¨ Activityï¼Œåˆ™å¯é€šè¿‡è°ƒç”¨ setContentIntent() æ¥æ·»åŠ  PendingIntentã€‚ åœ¨ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶å¯åŠ¨ Activity æ˜¯æœ€å¸¸è§çš„æ“ä½œåœºæ™¯ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥åœ¨ç”¨æˆ·æ¸…é™¤é€šçŸ¥æ—¶å¯åŠ¨ Activityã€‚åœ¨ Android 4.">
<title></title>

<link rel='canonical' href='http://localhost:1313/android/ui/notifications/'>

<link rel="stylesheet" href="/scss/style.min.d0a16b8285afbefdc07c79fbf6282161f02e29094d9cc49a298d4e2016d2afc7.css"><meta property='og:title' content="">
<meta property='og:description' content="é€šçŸ¥ é€šçŸ¥æ˜¯æ‚¨å¯ä»¥åœ¨åº”ç”¨çš„å¸¸è§„ UI å¤–éƒ¨å‘ç”¨æˆ·æ˜¾ç¤ºçš„æ¶ˆæ¯ã€‚å½“æ‚¨å‘ŠçŸ¥ç³»ç»Ÿå‘å‡ºé€šçŸ¥æ—¶ï¼Œå®ƒå°†å…ˆä»¥å›¾æ ‡çš„å½¢å¼æ˜¾ç¤ºåœ¨é€šçŸ¥åŒºåŸŸä¸­ã€‚ç”¨æˆ·å¯ä»¥æ‰“å¼€æŠ½å±‰å¼é€šçŸ¥æ æŸ¥çœ‹é€šçŸ¥çš„è¯¦ç»†ä¿¡æ¯ã€‚ é€šçŸ¥åŒºåŸŸå’ŒæŠ½å±‰å¼é€šçŸ¥æ å‡æ˜¯ç”±ç³»ç»Ÿæ§åˆ¶çš„åŒºåŸŸï¼Œç”¨æˆ·å¯ä»¥éšæ—¶æŸ¥çœ‹ã€‚ åˆ›å»ºé€šçŸ¥ SupportV4åŒ…æä¾›äº† NotificationCompat.Builder ç±»ã€‚Android 3.0ï¼ˆAPI çº§åˆ« 11ï¼‰ä¸­å·²æ·»åŠ ç±» Notification.Builderã€‚ æ‚¨å¯ä»¥åœ¨ NotificationCompat.Builder å¯¹è±¡ä¸­ä¸ºé€šçŸ¥æŒ‡å®š UI ä¿¡æ¯å’Œæ“ä½œã€‚è¦åˆ›å»ºé€šçŸ¥ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder.build()ï¼Œå®ƒå°†è¿”å›åŒ…å«æ‚¨çš„å…·ä½“è§„èŒƒçš„ Notification å¯¹è±¡ã€‚è¦å‘å‡ºé€šçŸ¥ï¼Œè¯·é€šè¿‡è°ƒç”¨ NotificationManager.notify() å°† Notification å¯¹è±¡ä¼ é€’ç»™ç³»ç»Ÿã€‚ å¿…éœ€çš„é€šçŸ¥å†…å®¹ Notification å¯¹è±¡å¿…é¡»åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š å°å›¾æ ‡ï¼Œç”± setSmallIcon() è®¾ç½® æ ‡é¢˜ï¼Œç”± setContentTitle() è®¾ç½® è¯¦ç»†æ–‡æœ¬ï¼Œç”± setContentText() è®¾ç½® å¯é€‰é€šçŸ¥å†…å®¹å’Œè®¾ç½® æ‰€æœ‰å…¶ä»–é€šçŸ¥è®¾ç½®å’Œå†…å®¹éƒ½æ˜¯å¯é€‰çš„ã€‚å¦‚éœ€äº†è§£æœ‰å…³å®ƒä»¬çš„æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜… NotificationCompat.Builder å‚è€ƒæ–‡æ¡£ã€‚ é€šçŸ¥æ“ä½œ å°½ç®¡é€šçŸ¥æ“ä½œéƒ½æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯æ‚¨è‡³å°‘åº”å‘é€šçŸ¥æ·»åŠ ä¸€ä¸ªæ“ä½œã€‚ æ“ä½œå…è®¸ç”¨æˆ·ç›´æ¥ä»é€šçŸ¥è½¬åˆ°åº”ç”¨ä¸­çš„ Activityï¼Œä»–ä»¬å¯åœ¨å…¶ä¸­æŸ¥çœ‹ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶æˆ–æ‰§è¡Œè¿›ä¸€æ­¥çš„æ“ä½œã€‚ ä¸€ä¸ªé€šçŸ¥å¯ä»¥æä¾›å¤šä¸ªæ“ä½œã€‚æ‚¨åº”è¯¥å§‹ç»ˆå®šä¹‰ä¸€ä¸ªå½“ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶ä¼šè§¦å‘çš„æ“ä½œï¼›é€šå¸¸ï¼Œæ­¤æ“ä½œä¼šåœ¨åº”ç”¨ä¸­æ‰“å¼€ Activityã€‚ æ‚¨ä¹Ÿå¯ä»¥å‘é€šçŸ¥æ·»åŠ æŒ‰é’®æ¥æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œä¾‹å¦‚ï¼Œæš‚åœé—¹é“ƒæˆ–ç«‹å³ç­”å¤çŸ­ä¿¡ï¼›æ­¤åŠŸèƒ½è‡ª Android 4.1 èµ·å¯ç”¨ã€‚å¦‚æœä½¿ç”¨å…¶ä»–æ“ä½œæŒ‰é’®ï¼Œåˆ™æ‚¨è¿˜å¿…é¡»ä½¿è¿™äº›æŒ‰é’®çš„åŠŸèƒ½åœ¨åº”ç”¨çš„ Activity ä¸­å¯ç”¨ï¼› åœ¨ Notification å†…éƒ¨ï¼Œæ“ä½œæœ¬èº«ç”± PendingIntent å®šä¹‰ï¼Œåè€…åŒ…å«åœ¨åº”ç”¨ä¸­å¯åŠ¨ Activity çš„ Intentã€‚è¦å°† PendingIntent ä¸æ‰‹åŠ¿ç›¸å…³è”ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder çš„é€‚å½“æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦åœ¨ç”¨æˆ·ç‚¹å‡»æŠ½å±‰å¼é€šçŸ¥æ ä¸­çš„é€šçŸ¥æ–‡æœ¬æ—¶å¯åŠ¨ Activityï¼Œåˆ™å¯é€šè¿‡è°ƒç”¨ setContentIntent() æ¥æ·»åŠ  PendingIntentã€‚ åœ¨ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶å¯åŠ¨ Activity æ˜¯æœ€å¸¸è§çš„æ“ä½œåœºæ™¯ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥åœ¨ç”¨æˆ·æ¸…é™¤é€šçŸ¥æ—¶å¯åŠ¨ Activityã€‚åœ¨ Android 4.">
<meta property='og:url' content='http://localhost:1313/android/ui/notifications/'>
<meta property='og:site_name' content='Malinkang&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Android' />
<meta name="twitter:title" content="">
<meta name="twitter:description" content="é€šçŸ¥ é€šçŸ¥æ˜¯æ‚¨å¯ä»¥åœ¨åº”ç”¨çš„å¸¸è§„ UI å¤–éƒ¨å‘ç”¨æˆ·æ˜¾ç¤ºçš„æ¶ˆæ¯ã€‚å½“æ‚¨å‘ŠçŸ¥ç³»ç»Ÿå‘å‡ºé€šçŸ¥æ—¶ï¼Œå®ƒå°†å…ˆä»¥å›¾æ ‡çš„å½¢å¼æ˜¾ç¤ºåœ¨é€šçŸ¥åŒºåŸŸä¸­ã€‚ç”¨æˆ·å¯ä»¥æ‰“å¼€æŠ½å±‰å¼é€šçŸ¥æ æŸ¥çœ‹é€šçŸ¥çš„è¯¦ç»†ä¿¡æ¯ã€‚ é€šçŸ¥åŒºåŸŸå’ŒæŠ½å±‰å¼é€šçŸ¥æ å‡æ˜¯ç”±ç³»ç»Ÿæ§åˆ¶çš„åŒºåŸŸï¼Œç”¨æˆ·å¯ä»¥éšæ—¶æŸ¥çœ‹ã€‚ åˆ›å»ºé€šçŸ¥ SupportV4åŒ…æä¾›äº† NotificationCompat.Builder ç±»ã€‚Android 3.0ï¼ˆAPI çº§åˆ« 11ï¼‰ä¸­å·²æ·»åŠ ç±» Notification.Builderã€‚ æ‚¨å¯ä»¥åœ¨ NotificationCompat.Builder å¯¹è±¡ä¸­ä¸ºé€šçŸ¥æŒ‡å®š UI ä¿¡æ¯å’Œæ“ä½œã€‚è¦åˆ›å»ºé€šçŸ¥ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder.build()ï¼Œå®ƒå°†è¿”å›åŒ…å«æ‚¨çš„å…·ä½“è§„èŒƒçš„ Notification å¯¹è±¡ã€‚è¦å‘å‡ºé€šçŸ¥ï¼Œè¯·é€šè¿‡è°ƒç”¨ NotificationManager.notify() å°† Notification å¯¹è±¡ä¼ é€’ç»™ç³»ç»Ÿã€‚ å¿…éœ€çš„é€šçŸ¥å†…å®¹ Notification å¯¹è±¡å¿…é¡»åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š å°å›¾æ ‡ï¼Œç”± setSmallIcon() è®¾ç½® æ ‡é¢˜ï¼Œç”± setContentTitle() è®¾ç½® è¯¦ç»†æ–‡æœ¬ï¼Œç”± setContentText() è®¾ç½® å¯é€‰é€šçŸ¥å†…å®¹å’Œè®¾ç½® æ‰€æœ‰å…¶ä»–é€šçŸ¥è®¾ç½®å’Œå†…å®¹éƒ½æ˜¯å¯é€‰çš„ã€‚å¦‚éœ€äº†è§£æœ‰å…³å®ƒä»¬çš„æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜… NotificationCompat.Builder å‚è€ƒæ–‡æ¡£ã€‚ é€šçŸ¥æ“ä½œ å°½ç®¡é€šçŸ¥æ“ä½œéƒ½æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯æ‚¨è‡³å°‘åº”å‘é€šçŸ¥æ·»åŠ ä¸€ä¸ªæ“ä½œã€‚ æ“ä½œå…è®¸ç”¨æˆ·ç›´æ¥ä»é€šçŸ¥è½¬åˆ°åº”ç”¨ä¸­çš„ Activityï¼Œä»–ä»¬å¯åœ¨å…¶ä¸­æŸ¥çœ‹ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶æˆ–æ‰§è¡Œè¿›ä¸€æ­¥çš„æ“ä½œã€‚ ä¸€ä¸ªé€šçŸ¥å¯ä»¥æä¾›å¤šä¸ªæ“ä½œã€‚æ‚¨åº”è¯¥å§‹ç»ˆå®šä¹‰ä¸€ä¸ªå½“ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶ä¼šè§¦å‘çš„æ“ä½œï¼›é€šå¸¸ï¼Œæ­¤æ“ä½œä¼šåœ¨åº”ç”¨ä¸­æ‰“å¼€ Activityã€‚ æ‚¨ä¹Ÿå¯ä»¥å‘é€šçŸ¥æ·»åŠ æŒ‰é’®æ¥æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œä¾‹å¦‚ï¼Œæš‚åœé—¹é“ƒæˆ–ç«‹å³ç­”å¤çŸ­ä¿¡ï¼›æ­¤åŠŸèƒ½è‡ª Android 4.1 èµ·å¯ç”¨ã€‚å¦‚æœä½¿ç”¨å…¶ä»–æ“ä½œæŒ‰é’®ï¼Œåˆ™æ‚¨è¿˜å¿…é¡»ä½¿è¿™äº›æŒ‰é’®çš„åŠŸèƒ½åœ¨åº”ç”¨çš„ Activity ä¸­å¯ç”¨ï¼› åœ¨ Notification å†…éƒ¨ï¼Œæ“ä½œæœ¬èº«ç”± PendingIntent å®šä¹‰ï¼Œåè€…åŒ…å«åœ¨åº”ç”¨ä¸­å¯åŠ¨ Activity çš„ Intentã€‚è¦å°† PendingIntent ä¸æ‰‹åŠ¿ç›¸å…³è”ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder çš„é€‚å½“æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦åœ¨ç”¨æˆ·ç‚¹å‡»æŠ½å±‰å¼é€šçŸ¥æ ä¸­çš„é€šçŸ¥æ–‡æœ¬æ—¶å¯åŠ¨ Activityï¼Œåˆ™å¯é€šè¿‡è°ƒç”¨ setContentIntent() æ¥æ·»åŠ  PendingIntentã€‚ åœ¨ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶å¯åŠ¨ Activity æ˜¯æœ€å¸¸è§çš„æ“ä½œåœºæ™¯ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥åœ¨ç”¨æˆ·æ¸…é™¤é€šçŸ¥æ—¶å¯åŠ¨ Activityã€‚åœ¨ Android 4.">
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-G84J9N38RL"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-G84J9N38RL');
        }
      </script>
    
  

<style>
    :root {
        --sys-font-family: "LXGW WenKai TC";
        --zh-font-family: "LXGW WenKai TC";
        --base-font-family: "LXGW WenKai TC";
        --code-font-family: "LXGW WenKai TC";
        --article-font-family: "LXGW WenKai TC";
    }
</style>

<script>
    (function () {
        const customFont = document.createElement("link");
        customFont.href = "https://fonts.googleapis.com/css2?family=LXGW+WenKai+Mono+TC&family=LXGW+WenKai+TC&display=swap";
        customFont.type = "text/css";
        customFont.rel = "stylesheet";
        document.head.appendChild(customFont);
    })();
</script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/images/avatar_hu74e4307e0baa534a3da4ee0210445065_34446_300x0_resize_q75_box.jpeg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Malinkang&#39;s Blog</a></h1>
            <h2 class="site-description">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/malinkang'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/malinkang'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/pages/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/pages/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/pages/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å¥½å‹</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#åˆ›å»ºé€šçŸ¥">åˆ›å»ºé€šçŸ¥</a>
      <ol>
        <li><a href="#å¿…éœ€çš„é€šçŸ¥å†…å®¹">å¿…éœ€çš„é€šçŸ¥å†…å®¹</a></li>
      </ol>
    </li>
    <li><a href="#å¯é€‰é€šçŸ¥å†…å®¹å’Œè®¾ç½®">å¯é€‰é€šçŸ¥å†…å®¹å’Œè®¾ç½®</a>
      <ol>
        <li><a href="#é€šçŸ¥æ“ä½œ">é€šçŸ¥æ“ä½œ</a></li>
        <li><a href="#é€šçŸ¥ä¼˜å…ˆçº§">é€šçŸ¥ä¼˜å…ˆçº§</a></li>
        <li><a href="#åˆ›å»ºç®€å•é€šçŸ¥">åˆ›å»ºç®€å•é€šçŸ¥</a></li>
        <li><a href="#é€šçŸ¥çš„å…¶ä»–è®¾ç½®">é€šçŸ¥çš„å…¶ä»–è®¾ç½®</a></li>
      </ol>
    </li>
    <li><a href="#å°†æ‰©å±•å¸ƒå±€åº”ç”¨äºé€šçŸ¥">å°†æ‰©å±•å¸ƒå±€åº”ç”¨äºé€šçŸ¥</a>
      <ol>
        <li><a href="#å¤„ç†å…¼å®¹æ€§">å¤„ç†å…¼å®¹æ€§</a></li>
      </ol>
    </li>
    <li><a href="#ç®¡ç†é€šçŸ¥">ç®¡ç†é€šçŸ¥</a>
      <ol>
        <li><a href="#æ›´æ–°é€šçŸ¥">æ›´æ–°é€šçŸ¥</a></li>
        <li><a href="#åˆ é™¤é€šçŸ¥">åˆ é™¤é€šçŸ¥</a></li>
      </ol>
    </li>
    <li><a href="#å¯åŠ¨-activity-æ—¶ä¿ç•™å¯¼èˆª">å¯åŠ¨ Activity æ—¶ä¿ç•™å¯¼èˆª</a>
      <ol>
        <li><a href="#è®¾ç½®å¸¸è§„-activity-pendingintent">è®¾ç½®å¸¸è§„ Activity PendingIntent</a></li>
        <li><a href="#è®¾ç½®ç‰¹æ®Š-activity-pendingintent">è®¾ç½®ç‰¹æ®Š Activity PendingIntent</a></li>
      </ol>
    </li>
    <li><a href="#åœ¨é€šçŸ¥ä¸­æ˜¾ç¤ºè¿›åº¦">åœ¨é€šçŸ¥ä¸­æ˜¾ç¤ºè¿›åº¦</a>
      <ol>
        <li><a href="#æ˜¾ç¤ºæŒç»­æ—¶é—´å›ºå®šçš„è¿›åº¦æŒ‡ç¤ºå™¨">æ˜¾ç¤ºæŒç»­æ—¶é—´å›ºå®šçš„è¿›åº¦æŒ‡ç¤ºå™¨</a></li>
        <li><a href="#æ˜¾ç¤ºæŒç»­-activity-æŒ‡ç¤ºå™¨">æ˜¾ç¤ºæŒç»­ Activity æŒ‡ç¤ºå™¨</a></li>
      </ol>
    </li>
    <li><a href="#é€šçŸ¥å…ƒæ•°æ®">é€šçŸ¥å…ƒæ•°æ®</a></li>
    <li><a href="#æµ®åŠ¨é€šçŸ¥">æµ®åŠ¨é€šçŸ¥</a></li>
    <li><a href="#é”å®šå±å¹•é€šçŸ¥">é”å®šå±å¹•é€šçŸ¥</a></li>
    <li><a href="#è®¾ç½®å¯è§æ€§">è®¾ç½®å¯è§æ€§</a></li>
    <li><a href="#åœ¨é”å®šå±å¹•ä¸Šæ§åˆ¶åª’ä½“æ’­æ”¾">åœ¨é”å®šå±å¹•ä¸Šæ§åˆ¶åª’ä½“æ’­æ”¾</a></li>
    <li><a href="#è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€">è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€</a>
      <ol>
        <li><a href="#å¯¹è‡ªå®šä¹‰é€šçŸ¥æ–‡æœ¬ä½¿ç”¨æ ·å¼èµ„æº">å¯¹è‡ªå®šä¹‰é€šçŸ¥æ–‡æœ¬ä½¿ç”¨æ ·å¼èµ„æº</a></li>
      </ol>
    </li>
    <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/android/ui/notifications/"></a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    8 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="é€šçŸ¥">é€šçŸ¥
</h1><p>é€šçŸ¥æ˜¯æ‚¨å¯ä»¥åœ¨åº”ç”¨çš„å¸¸è§„ UI å¤–éƒ¨å‘ç”¨æˆ·æ˜¾ç¤ºçš„æ¶ˆæ¯ã€‚å½“æ‚¨å‘ŠçŸ¥ç³»ç»Ÿå‘å‡ºé€šçŸ¥æ—¶ï¼Œå®ƒå°†å…ˆä»¥å›¾æ ‡çš„å½¢å¼æ˜¾ç¤ºåœ¨é€šçŸ¥åŒºåŸŸä¸­ã€‚ç”¨æˆ·å¯ä»¥æ‰“å¼€æŠ½å±‰å¼é€šçŸ¥æ æŸ¥çœ‹é€šçŸ¥çš„è¯¦ç»†ä¿¡æ¯ã€‚ é€šçŸ¥åŒºåŸŸå’ŒæŠ½å±‰å¼é€šçŸ¥æ å‡æ˜¯ç”±ç³»ç»Ÿæ§åˆ¶çš„åŒºåŸŸï¼Œç”¨æˆ·å¯ä»¥éšæ—¶æŸ¥çœ‹ã€‚</p>
<p><img src="/.gitbook/assets/notification%5c_area%20%282%29%20%282%29%20%282%29%20%281%29%20%282%29%20%282%29%20%282%29%20%282%29%20%281%29.png"
	
	
	
	loading="lazy"
	
		alt="å›¾ 1. é€šçŸ¥åŒºåŸŸä¸­çš„é€šçŸ¥ã€‚"
	
	
></p>
<p><img src="/.gitbook/assets/notification%5c_drawer%20%282%29%20%282%29%20%282%29%20%282%29%20%282%29%20%282%29%20%282%29.png"
	
	
	
	loading="lazy"
	
		alt="å›¾ 2. æŠ½å±‰å¼é€šçŸ¥æ ä¸­çš„é€šçŸ¥ã€‚"
	
	
></p>
<h2 id="åˆ›å»ºé€šçŸ¥">åˆ›å»ºé€šçŸ¥
</h2><p>SupportV4åŒ…æä¾›äº† <a class="link" href="https://developer.android.com/reference/android/support/v4/app/NotificationCompat.Builder.html"  target="_blank" rel="noopener"
    >NotificationCompat.Builder</a> ç±»ã€‚Android 3.0ï¼ˆAPI çº§åˆ« 11ï¼‰ä¸­å·²æ·»åŠ ç±» <a class="link" href="https://developer.android.com/reference/android/app/Notification.Builder.html"  target="_blank" rel="noopener"
    >Notification.Builder</a>ã€‚</p>
<p>æ‚¨å¯ä»¥åœ¨ NotificationCompat.Builder å¯¹è±¡ä¸­ä¸ºé€šçŸ¥æŒ‡å®š UI ä¿¡æ¯å’Œæ“ä½œã€‚è¦åˆ›å»ºé€šçŸ¥ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder.build()ï¼Œå®ƒå°†è¿”å›åŒ…å«æ‚¨çš„å…·ä½“è§„èŒƒçš„ Notification å¯¹è±¡ã€‚è¦å‘å‡ºé€šçŸ¥ï¼Œè¯·é€šè¿‡è°ƒç”¨ NotificationManager.notify() å°† Notification å¯¹è±¡ä¼ é€’ç»™ç³»ç»Ÿã€‚</p>
<h3 id="å¿…éœ€çš„é€šçŸ¥å†…å®¹">å¿…éœ€çš„é€šçŸ¥å†…å®¹
</h3><p>Notification å¯¹è±¡å¿…é¡»åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>å°å›¾æ ‡ï¼Œç”± setSmallIcon() è®¾ç½®</li>
<li>æ ‡é¢˜ï¼Œç”± setContentTitle() è®¾ç½®</li>
<li>è¯¦ç»†æ–‡æœ¬ï¼Œç”± setContentText() è®¾ç½®</li>
</ul>
<h2 id="å¯é€‰é€šçŸ¥å†…å®¹å’Œè®¾ç½®">å¯é€‰é€šçŸ¥å†…å®¹å’Œè®¾ç½®
</h2><p>æ‰€æœ‰å…¶ä»–é€šçŸ¥è®¾ç½®å’Œå†…å®¹éƒ½æ˜¯å¯é€‰çš„ã€‚å¦‚éœ€äº†è§£æœ‰å…³å®ƒä»¬çš„æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜… NotificationCompat.Builder å‚è€ƒæ–‡æ¡£ã€‚</p>
<h3 id="é€šçŸ¥æ“ä½œ">é€šçŸ¥æ“ä½œ
</h3><p>å°½ç®¡é€šçŸ¥æ“ä½œéƒ½æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯æ‚¨è‡³å°‘åº”å‘é€šçŸ¥æ·»åŠ ä¸€ä¸ªæ“ä½œã€‚ æ“ä½œå…è®¸ç”¨æˆ·ç›´æ¥ä»é€šçŸ¥è½¬åˆ°åº”ç”¨ä¸­çš„ Activityï¼Œä»–ä»¬å¯åœ¨å…¶ä¸­æŸ¥çœ‹ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶æˆ–æ‰§è¡Œè¿›ä¸€æ­¥çš„æ“ä½œã€‚</p>
<p>ä¸€ä¸ªé€šçŸ¥å¯ä»¥æä¾›å¤šä¸ªæ“ä½œã€‚æ‚¨åº”è¯¥å§‹ç»ˆå®šä¹‰ä¸€ä¸ªå½“ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶ä¼šè§¦å‘çš„æ“ä½œï¼›é€šå¸¸ï¼Œæ­¤æ“ä½œä¼šåœ¨åº”ç”¨ä¸­æ‰“å¼€ Activityã€‚ æ‚¨ä¹Ÿå¯ä»¥å‘é€šçŸ¥æ·»åŠ æŒ‰é’®æ¥æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œä¾‹å¦‚ï¼Œæš‚åœé—¹é“ƒæˆ–ç«‹å³ç­”å¤çŸ­ä¿¡ï¼›æ­¤åŠŸèƒ½è‡ª Android 4.1 èµ·å¯ç”¨ã€‚å¦‚æœä½¿ç”¨å…¶ä»–æ“ä½œæŒ‰é’®ï¼Œåˆ™æ‚¨è¿˜å¿…é¡»ä½¿è¿™äº›æŒ‰é’®çš„åŠŸèƒ½åœ¨åº”ç”¨çš„ Activity ä¸­å¯ç”¨ï¼›</p>
<p>åœ¨ Notification å†…éƒ¨ï¼Œæ“ä½œæœ¬èº«ç”± PendingIntent å®šä¹‰ï¼Œåè€…åŒ…å«åœ¨åº”ç”¨ä¸­å¯åŠ¨ Activity çš„ Intentã€‚è¦å°† PendingIntent ä¸æ‰‹åŠ¿ç›¸å…³è”ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder çš„é€‚å½“æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦åœ¨ç”¨æˆ·ç‚¹å‡»æŠ½å±‰å¼é€šçŸ¥æ ä¸­çš„é€šçŸ¥æ–‡æœ¬æ—¶å¯åŠ¨ Activityï¼Œåˆ™å¯é€šè¿‡è°ƒç”¨ setContentIntent() æ¥æ·»åŠ  PendingIntentã€‚</p>
<p>åœ¨ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶å¯åŠ¨ Activity æ˜¯æœ€å¸¸è§çš„æ“ä½œåœºæ™¯ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥åœ¨ç”¨æˆ·æ¸…é™¤é€šçŸ¥æ—¶å¯åŠ¨ Activityã€‚åœ¨ Android 4.1 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ“ä½œæŒ‰é’®å¯åŠ¨ Activityã€‚</p>
<h3 id="é€šçŸ¥ä¼˜å…ˆçº§">é€šçŸ¥ä¼˜å…ˆçº§
</h3><p>æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®é€šçŸ¥çš„ä¼˜å…ˆçº§ã€‚ä¼˜å…ˆçº§å……å½“ä¸€ä¸ªæç¤ºï¼Œæé†’è®¾å¤‡ UI åº”è¯¥å¦‚ä½•æ˜¾ç¤ºé€šçŸ¥ã€‚ è¦è®¾ç½®é€šçŸ¥çš„ä¼˜å…ˆçº§ï¼Œè¯·è°ƒç”¨ NotificationCompat.Builder.setPriority() å¹¶ä¼ å…¥ä¸€ä¸ª NotificationCompat ä¼˜å…ˆçº§å¸¸é‡ã€‚æœ‰äº”ä¸ªä¼˜å…ˆçº§åˆ«ï¼ŒèŒƒå›´ä» NotificationCompat.PRIORITY_MIN (-2) åˆ° NotificationCompat.PRIORITY_MAX (2)ï¼›å¦‚æœæœªè®¾ç½®ï¼Œåˆ™ä¼˜å…ˆçº§é»˜è®¤ä¸º PRIORITY_DEFAULT (0)ã€‚</p>
<p>æœ‰å…³è®¾ç½®é€‚å½“ä¼˜å…ˆçº§åˆ«çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…<a class="link" href="https://material.io/guidelines/patterns/notifications.html"  target="_blank" rel="noopener"
    >é€šçŸ¥è®¾è®¡æŒ‡å—</a>ä¸­çš„â€œæ­£ç¡®è®¾ç½®å’Œç®¡ç†é€šçŸ¥ä¼˜å…ˆçº§â€</p>
<h3 id="åˆ›å»ºç®€å•é€šçŸ¥">åˆ›å»ºç®€å•é€šçŸ¥
</h3><p>ä»¥ä¸‹ä»£ç æ®µè¯´æ˜äº†ä¸€ä¸ªæŒ‡å®šæŸé¡¹ Activity åœ¨ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶æ‰“å¼€çš„ç®€å•é€šçŸ¥ã€‚ è¯·æ³¨æ„ï¼Œè¯¥ä»£ç å°†åˆ›å»º TaskStackBuilder å¯¹è±¡å¹¶ä½¿ç”¨å®ƒæ¥ä¸ºæ“ä½œåˆ›å»º PendingIntentã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="w"> </span><span class="n">mBuilder</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="na">setSmallIcon</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">notification_icon</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="na">setContentTitle</span><span class="p">(</span><span class="s">&#34;My notification&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="na">setContentText</span><span class="p">(</span><span class="s">&#34;Hello World!&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Creates an explicit intent for an Activity in your app</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Intent</span><span class="w"> </span><span class="n">resultIntent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Intent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">ResultActivity</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// The stack builder object will contain an artificial back stack for the</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// started Activity.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// This ensures that navigating backward from the Activity leads out of</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// your application to the Home screen.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">TaskStackBuilder</span><span class="w"> </span><span class="n">stackBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TaskStackBuilder</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Adds the back stack for the Intent (but not the Intent itself)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stackBuilder</span><span class="p">.</span><span class="na">addParentStack</span><span class="p">(</span><span class="n">ResultActivity</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Adds the Intent that starts the Activity to the top of the stack</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stackBuilder</span><span class="p">.</span><span class="na">addNextIntent</span><span class="p">(</span><span class="n">resultIntent</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PendingIntent</span><span class="w"> </span><span class="n">resultPendingIntent</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">stackBuilder</span><span class="p">.</span><span class="na">getPendingIntent</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">PendingIntent</span><span class="p">.</span><span class="na">FLAG_UPDATE_CURRENT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mBuilder</span><span class="p">.</span><span class="na">setContentIntent</span><span class="p">(</span><span class="n">resultPendingIntent</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">NotificationManager</span><span class="w"> </span><span class="n">mNotificationManager</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="n">NotificationManager</span><span class="p">)</span><span class="w"> </span><span class="n">getSystemService</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="na">NOTIFICATION_SERVICE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// mId allows you to update the notification later on.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mNotificationManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="n">mId</span><span class="p">,</span><span class="w"> </span><span class="n">mBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å°±è¿™ä¹ˆç®€å•ã€‚æ‚¨çš„ç”¨æˆ·ç°å·²æ”¶åˆ°é€šçŸ¥ã€‚</p>
<h3 id="é€šçŸ¥çš„å…¶ä»–è®¾ç½®">é€šçŸ¥çš„å…¶ä»–è®¾ç½®
</h3><p>å¯ä»¥é€šè¿‡è°ƒç”¨Notificationçš„å±æ€§ä¸ºé€šçŸ¥æ·»åŠ æ›´å¤šçš„è®¾ç½®ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Notification</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//è®¾ç½®é“ƒå£°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">notification</span><span class="p">.</span><span class="na">sound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RingtoneManager</span><span class="p">.</span><span class="na">getDefaultUri</span><span class="p">(</span><span class="n">RingtoneManager</span><span class="p">.</span><span class="na">TYPE_ALARM</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//è®¾ç½®LEDé—ªçƒ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">notification</span><span class="p">.</span><span class="na">ledARGB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">GREEN</span><span class="p">;</span><span class="c1">// æ§åˆ¶ LED ç¯çš„é¢œè‰²ï¼Œä¸€èˆ¬æœ‰çº¢ç»¿è“ä¸‰ç§é¢œè‰²å¯é€‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">notification</span><span class="p">.</span><span class="na">ledOnMS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1000</span><span class="p">;</span><span class="c1">// æŒ‡å®š LED ç¯äº®èµ·çš„æ—¶é•¿ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">notification</span><span class="p">.</span><span class="na">ledOffMS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1000</span><span class="p">;</span><span class="c1">// æŒ‡å®š LED ç¯æš—å»çš„æ—¶é•¿ï¼Œä¹Ÿæ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">notification</span><span class="p">.</span><span class="na">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Notification</span><span class="p">.</span><span class="na">FLAG_SHOW_LIGHTS</span><span class="p">;</span><span class="c1">// æŒ‡å®šé€šçŸ¥çš„ä¸€äº›è¡Œä¸ºï¼Œå…¶ä¸­å°±åŒ…æ‹¬æ˜¾ç¤º</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//è®¾ç½®éœ‡åŠ¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">long</span><span class="o">[]</span><span class="w"> </span><span class="n">vibrates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">1000</span><span class="p">,</span><span class="w"> </span><span class="n">1000</span><span class="p">,</span><span class="w"> </span><span class="n">1000</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">notification</span><span class="p">.</span><span class="na">vibrate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vibrates</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// mId allows you to update the notification later on.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mNotificationManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">notification</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å°†æ‰©å±•å¸ƒå±€åº”ç”¨äºé€šçŸ¥">å°†æ‰©å±•å¸ƒå±€åº”ç”¨äºé€šçŸ¥
</h2><p>è¦ä½¿é€šçŸ¥å‡ºç°åœ¨å±•å¼€è§†å›¾ä¸­ï¼Œè¯·å…ˆåˆ›å»ºä¸€ä¸ªå¸¦æœ‰æ‰€éœ€æ™®é€šè§†å›¾é€‰é¡¹çš„ NotificationCompat.Builder å¯¹è±¡ã€‚æ¥ä¸‹æ¥ï¼Œè°ƒç”¨ä»¥æ‰©å±•å¸ƒå±€å¯¹è±¡ä½œä¸ºå…¶å‚æ•°çš„ Builder.setStyle()ã€‚</p>
<p>è¯·è®°ä½ï¼Œæ‰©å±•é€šçŸ¥åœ¨ Android 4.1 ä¹‹å‰çš„å¹³å°ä¸Šä¸å¯ç”¨ã€‚è¦äº†è§£å¦‚ä½•å¤„ç†é’ˆå¯¹ Android 4.1 åŠæ›´æ—©ç‰ˆæœ¬å¹³å°çš„é€šçŸ¥ï¼Œè¯·é˜…è¯»å¤„ç†å…¼å®¹æ€§éƒ¨åˆ†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç æ®µæ¼”ç¤ºäº†å¦‚ä½•æ›´æ”¹åœ¨å‰é¢çš„ä»£ç æ®µä¸­åˆ›å»ºçš„é€šçŸ¥ï¼Œä»¥ä¾¿ä½¿ç”¨æ‰©å±•å¸ƒå±€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="w"> </span><span class="n">mBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setSmallIcon</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">notification_icon</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setContentTitle</span><span class="p">(</span><span class="s">&#34;Event tracker&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setContentText</span><span class="p">(</span><span class="s">&#34;Events received&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">InboxStyle</span><span class="w"> </span><span class="n">inboxStyle</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">InboxStyle</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[</span><span class="n">6</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Sets a title for the Inbox in expanded layout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">inboxStyle</span><span class="p">.</span><span class="na">setBigContentTitle</span><span class="p">(</span><span class="s">&#34;Event tracker details:&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Moves events into the expanded layout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">events</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">inboxStyle</span><span class="p">.</span><span class="na">addLine</span><span class="p">(</span><span class="n">events</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Moves the expanded layout object into the notification object.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mBuilder</span><span class="p">.</span><span class="na">setStyle</span><span class="p">(</span><span class="n">inBoxStyle</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Issue the notification here.</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å¤„ç†å…¼å®¹æ€§">å¤„ç†å…¼å®¹æ€§
</h3><p>å¹¶éæ‰€æœ‰é€šçŸ¥åŠŸèƒ½éƒ½å¯ç”¨äºæŸç‰¹å®šç‰ˆæœ¬ï¼Œå³ä¾¿ç”¨äºè®¾ç½®è¿™äº›åŠŸèƒ½çš„æ–¹æ³•ä½äºæ”¯æŒåº“ç±» NotificationCompat.Builder ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ä¾‹å¦‚ï¼Œä¾èµ–äºæ‰©å±•é€šçŸ¥çš„æ“ä½œæŒ‰é’®ä»…ä¼šæ˜¾ç¤ºåœ¨ Android 4.1 åŠæ›´é«˜ç‰ˆæœ¬çš„ç³»ç»Ÿä¸­ï¼Œè¿™æ˜¯å› ä¸ºæ‰©å±•é€šçŸ¥æœ¬èº«ä»…åœ¨ Android 4.1 åŠæ›´é«˜ç‰ˆæœ¬çš„ç³»ç»Ÿä¸­å¯ç”¨ã€‚</p>
<p>ä¸ºäº†ç¡®ä¿æœ€ä½³å…¼å®¹æ€§ï¼Œè¯·ä½¿ç”¨ NotificationCompat åŠå…¶å­ç±»ï¼ˆç‰¹åˆ«æ˜¯ NotificationCompat.Builderï¼‰åˆ›å»ºé€šçŸ¥ã€‚æ­¤å¤–ï¼Œåœ¨å®ç°é€šçŸ¥æ—¶ï¼Œè¯·éµå¾ªä»¥ä¸‹æµç¨‹ï¼š</p>
<ol>
<li>
<p>ä¸ºæ‰€æœ‰ç”¨æˆ·æä¾›é€šçŸ¥çš„å…¨éƒ¨åŠŸèƒ½ï¼Œæ— è®ºä»–ä»¬ä½¿ç”¨ä½•ç§ç‰ˆæœ¬çš„ Android ç³»ç»Ÿã€‚ ä¸ºæ­¤ï¼Œè¯·éªŒè¯æ˜¯å¦å¯ä»åº”ç”¨çš„ Activity ä¸­è·å¾—æ‰€æœ‰åŠŸèƒ½ã€‚è¦æ‰§è¡Œæ­¤æ“ä½œï¼Œæ‚¨å¯èƒ½éœ€è¦æ·»åŠ æ–°çš„ Activityã€‚</p>
<p>ä¾‹å¦‚ï¼Œè‹¥è¦ä½¿ç”¨ addAction() æä¾›åœæ­¢å’Œå¯åŠ¨åª’ä½“æ’­æ”¾çš„æ§ä»¶ï¼Œè¯·å…ˆåœ¨åº”ç”¨çš„ Activity ä¸­å®ç°æ­¤æ§ä»¶ã€‚</p>
</li>
<li>
<p>ç¡®ä¿æ‰€æœ‰ç”¨æˆ·å‡å¯é€šè¿‡ç‚¹å‡»é€šçŸ¥å¯åŠ¨ Activity æ¥è·å¾—è¯¥Activityä¸­çš„åŠŸèƒ½ã€‚ ä¸ºæ­¤ï¼Œè¯·ä¸º Activity åˆ›å»º PendingIntentã€‚è°ƒç”¨ setContentIntent() ä»¥å°† PendingIntent æ·»åŠ åˆ°é€šçŸ¥ã€‚</p>
</li>
<li>
<p>ç°åœ¨ï¼Œå°†è¦ä½¿ç”¨çš„æ‰©å±•é€šçŸ¥åŠŸèƒ½æ·»åŠ åˆ°é€šçŸ¥ã€‚è¯·è®°ä½ï¼Œæ‚¨æ·»åŠ çš„ä»»ä½•åŠŸèƒ½è¿˜å¿…é¡»åœ¨ç”¨æˆ·ç‚¹å‡»é€šçŸ¥æ—¶å¯åŠ¨çš„ Activity ä¸­å¯ç”¨ã€‚</p>
</li>
</ol>
<h2 id="ç®¡ç†é€šçŸ¥">ç®¡ç†é€šçŸ¥
</h2><p>å½“æ‚¨éœ€è¦ä¸ºåŒä¸€ç±»å‹çš„äº‹ä»¶å¤šæ¬¡å‘å‡ºåŒä¸€é€šçŸ¥æ—¶ï¼Œåº”é¿å…åˆ›å»ºå…¨æ–°çš„é€šçŸ¥ï¼Œ è€Œæ˜¯åº”è€ƒè™‘é€šè¿‡æ›´æ”¹ä¹‹å‰é€šçŸ¥çš„æŸäº›å€¼å’Œ/æˆ–ä¸ºå…¶æ·»åŠ æŸäº›å€¼æ¥æ›´æ–°é€šçŸ¥ã€‚</p>
<p>ä¾‹å¦‚ï¼ŒGmail é€šè¿‡å¢åŠ æœªè¯»æ¶ˆæ¯è®¡æ•°å¹¶å°†æ¯å°ç”µå­é‚®ä»¶çš„æ‘˜è¦æ·»åŠ åˆ°é€šçŸ¥ï¼Œé€šçŸ¥ç”¨æˆ·æ”¶åˆ°äº†æ–°çš„ç”µå­é‚®ä»¶ã€‚ è¿™ç§°ä¸ºâ€œå †å â€é€šçŸ¥ï¼›é€šçŸ¥è®¾è®¡æŒ‡å—å¯¹æ­¤è¿›è¡Œäº†æ›´è¯¦å°½çš„æè¿°ã€‚</p>
<blockquote>
<p>æ³¨ï¼šæ­¤ Gmail åŠŸèƒ½éœ€è¦â€œæ”¶ä»¶ç®±â€æ‰©å±•å¸ƒå±€ï¼Œè¯¥å¸ƒå±€æ˜¯è‡ª Android 4.1 ç‰ˆæœ¬èµ·å¯ç”¨çš„æ‰©å±•é€šçŸ¥åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚</p>
</blockquote>
<h3 id="æ›´æ–°é€šçŸ¥">æ›´æ–°é€šçŸ¥
</h3><p>è¦å°†é€šçŸ¥è®¾ç½®ä¸ºèƒ½å¤Ÿæ›´æ–°ï¼Œè¯·é€šè¿‡è°ƒç”¨ NotificationManager.notify() å‘å‡ºå¸¦æœ‰é€šçŸ¥ ID çš„é€šçŸ¥ã€‚ è¦åœ¨å‘å‡ºä¹‹åæ›´æ–°æ­¤é€šçŸ¥ï¼Œè¯·æ›´æ–°æˆ–åˆ›å»º NotificationCompat.Builder å¯¹è±¡ï¼Œä»è¯¥å¯¹è±¡æ„å»º Notification å¯¹è±¡ï¼Œå¹¶å‘å‡ºä¸ä¹‹å‰æ‰€ç”¨ ID ç›¸åŒçš„ Notificationã€‚å¦‚æœä¹‹å‰çš„é€šçŸ¥ä»ç„¶å¯è§ï¼Œåˆ™ç³»ç»Ÿä¼šæ ¹æ® Notification å¯¹è±¡çš„å†…å®¹æ›´æ–°è¯¥é€šçŸ¥ã€‚ç›¸åï¼Œå¦‚æœä¹‹å‰çš„é€šçŸ¥å·²è¢«æ¸…é™¤ï¼Œç³»ç»Ÿåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°é€šçŸ¥ã€‚</p>
<p>ä»¥ä¸‹ä»£ç æ®µæ¼”ç¤ºäº†ç»è¿‡æ›´æ–°ä»¥åæ˜ æ‰€å‘ç”Ÿäº‹ä»¶æ•°é‡çš„é€šçŸ¥ã€‚ å®ƒå°†é€šçŸ¥å †å å¹¶æ˜¾ç¤ºæ‘˜è¦ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">mNotificationManager</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">(</span><span class="n">NotificationManager</span><span class="p">)</span><span class="w"> </span><span class="n">getSystemService</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="na">NOTIFICATION_SERVICE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Sets an ID for the notification, so it can be updated</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">int</span><span class="w"> </span><span class="n">notifyID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mNotifyBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setContentTitle</span><span class="p">(</span><span class="s">&#34;New Message&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setContentText</span><span class="p">(</span><span class="s">&#34;You&#39;ve received new messages.&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setSmallIcon</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">ic_notify_status</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">numMessages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Start of a loop that processes data and then notifies the user</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">mNotifyBuilder</span><span class="p">.</span><span class="na">setContentText</span><span class="p">(</span><span class="n">currentText</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="na">setNumber</span><span class="p">(</span><span class="o">++</span><span class="n">numMessages</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Because the ID remains unchanged, the existing notification is</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// updated.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">mNotificationManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">notifyID</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">mNotifyBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åˆ é™¤é€šçŸ¥">åˆ é™¤é€šçŸ¥
</h3><p>é™¤éå‘ç”Ÿä»¥ä¸‹æƒ…å†µä¹‹ä¸€ï¼Œå¦åˆ™é€šçŸ¥ä»ç„¶å¯è§ï¼š</p>
<ul>
<li>ç”¨æˆ·å•ç‹¬æˆ–é€šè¿‡ä½¿ç”¨â€œå…¨éƒ¨æ¸…é™¤â€æ¸…é™¤äº†è¯¥é€šçŸ¥ï¼ˆå¦‚æœé€šçŸ¥å¯ä»¥æ¸…é™¤ï¼‰ã€‚</li>
<li>ç”¨æˆ·ç‚¹å‡»é€šçŸ¥ï¼Œä¸”æ‚¨åœ¨åˆ›å»ºé€šçŸ¥æ—¶è°ƒç”¨äº† setAutoCancel()ã€‚</li>
<li>æ‚¨é’ˆå¯¹ç‰¹å®šçš„é€šçŸ¥ ID è°ƒç”¨äº† cancel()ã€‚æ­¤æ–¹æ³•è¿˜ä¼šåˆ é™¤å½“å‰é€šçŸ¥ã€‚</li>
<li>æ‚¨è°ƒç”¨äº† cancelAll() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†åˆ é™¤ä¹‹å‰å‘å‡ºçš„æ‰€æœ‰é€šçŸ¥ã€‚</li>
</ul>
<h2 id="å¯åŠ¨-activity-æ—¶ä¿ç•™å¯¼èˆª">å¯åŠ¨ Activity æ—¶ä¿ç•™å¯¼èˆª
</h2><p>ä»é€šçŸ¥ä¸­å¯åŠ¨ Activity æ—¶ï¼Œæ‚¨å¿…é¡»ä¿ç•™ç”¨æˆ·çš„é¢„æœŸå¯¼èˆªä½“éªŒã€‚ ç‚¹å‡»â€œè¿”å›â€åº”è¯¥ä½¿ç”¨æˆ·å°†åº”ç”¨çš„æ­£å¸¸å·¥ä½œæµå›é€€åˆ°ä¸»å±å¹•ï¼Œè€Œç‚¹å‡»â€œæœ€æ–°åŠ¨æ€â€åˆ™åº”å°† Activity æ˜¾ç¤ºä¸ºå•ç‹¬çš„ä»»åŠ¡ã€‚ è¦ä¿ç•™å¯¼èˆªä½“éªŒï¼Œæ‚¨åº”è¯¥åœ¨å…¨æ–°ä»»åŠ¡ä¸­å¯åŠ¨ Activityã€‚å¦‚ä½•è®¾ç½® PendingIntent ä»¥è·å¾—å…¨æ–°ä»»åŠ¡å–å†³äºæ­£åœ¨å¯åŠ¨çš„ Activity çš„æ€§è´¨ã€‚ä¸€èˆ¬æœ‰ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li>
<p>å¸¸è§„ Activityï¼š</p>
<p>æ‚¨è¦å¯åŠ¨çš„ Activity æ˜¯åº”ç”¨çš„æ­£å¸¸å·¥ä½œæµçš„ä¸€éƒ¨åˆ†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·è®¾ç½® PendingIntent ä»¥å¯åŠ¨å…¨æ–°ä»»åŠ¡å¹¶ä¸º PendingIntentæä¾›è¿”å›æ ˆï¼Œè¿™å°†é‡ç°åº”ç”¨çš„æ­£å¸¸â€œè¿”å›â€è¡Œä¸ºã€‚</p>
<p>Gmail åº”ç”¨ä¸­çš„é€šçŸ¥æ¼”ç¤ºäº†è¿™ä¸€ç‚¹ã€‚ç‚¹å‡»ä¸€å°ç”µå­é‚®ä»¶æ¶ˆæ¯çš„é€šçŸ¥æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°æ¶ˆæ¯å…·ä½“å†…å®¹ã€‚ è§¦æ‘¸è¿”å›å°†ä½¿æ‚¨ä» Gmail å›é€€åˆ°ä¸»å±å¹•ï¼Œå°±å¥½åƒæ‚¨æ˜¯ä»ä¸»å±å¹•ï¼ˆè€Œä¸æ˜¯é€šçŸ¥ï¼‰è¿›å…¥ Gmail ä¸€æ ·ã€‚</p>
</li>
</ul>
<p>æ— è®ºæ‚¨è§¦æ‘¸é€šçŸ¥æ—¶å¤„äºå“ªä¸ªåº”ç”¨ï¼Œéƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åœ¨ Gmail ä¸­æ’°å†™æ¶ˆæ¯æ—¶ç‚¹å‡»äº†ä¸€å°ç”µå­é‚®ä»¶çš„é€šçŸ¥ï¼Œåˆ™ä¼šç«‹å³è½¬åˆ°è¯¥ç”µå­é‚®ä»¶ã€‚ è§¦æ‘¸â€œè¿”å›â€ä¼šä¾æ¬¡è½¬åˆ°æ”¶ä»¶ç®±å’Œä¸»å±å¹•ï¼Œè€Œä¸æ˜¯è½¬åˆ°æ‚¨åœ¨æ’°å†™çš„é‚®ä»¶ã€‚</p>
<ul>
<li>
<p>ç‰¹æ®Š Activityï¼š</p>
<p>ä»…å½“ä»é€šçŸ¥ä¸­å¯åŠ¨æ—¶ï¼Œç”¨æˆ·æ‰ä¼šçœ‹åˆ°æ­¤ Activityã€‚ ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼ŒActivity æ˜¯é€šè¿‡æä¾›å¾ˆéš¾æ˜¾ç¤ºåœ¨é€šçŸ¥æœ¬èº«ä¸­çš„ä¿¡æ¯æ¥æ‰©å±•é€šçŸ¥ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œè¯·å°† PendingIntent è®¾ç½®ä¸ºåœ¨å…¨æ–°ä»»åŠ¡ä¸­å¯åŠ¨ã€‚ä½†æ˜¯ï¼Œç”±äºå¯åŠ¨çš„ Activity ä¸æ˜¯åº”ç”¨ Activity æµç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤æ— éœ€åˆ›å»ºè¿”å›æ ˆã€‚ç‚¹å‡»â€œè¿”å›â€ä»ä¼šå°†ç”¨æˆ·å¸¦åˆ°ä¸»å±å¹•ã€‚</p>
</li>
</ul>
<h3 id="è®¾ç½®å¸¸è§„-activity-pendingintent">è®¾ç½®å¸¸è§„ Activity PendingIntent
</h3><p>è¦è®¾ç½®å¯å¯åŠ¨ç›´æ¥è¿›å…¥ Activity çš„ PendingIntentï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>åœ¨æ¸…å•æ–‡ä»¶ä¸­å®šä¹‰åº”ç”¨çš„ Activity å±‚æ¬¡ç»“æ„ã€‚
<ul>
<li>
<p>æ·»åŠ å¯¹ Android 4.0.3 åŠæ›´ä½ç‰ˆæœ¬çš„æ”¯æŒã€‚ä¸ºæ­¤ï¼Œè¯·é€šè¿‡æ·»åŠ  å…ƒç´ ä½œä¸º çš„å­é¡¹æ¥æŒ‡å®šæ­£åœ¨å¯åŠ¨çš„ Activity çš„çˆ¶é¡¹ã€‚</p>
<p>å¯¹äºæ­¤å…ƒç´ ï¼Œè¯·è®¾ç½® android:name=&ldquo;android.support.PARENT_ACTIVITY&rdquo;ã€‚ è®¾ç½® android:value=&quot;&quot;ï¼Œå…¶ä¸­ï¼Œ æ˜¯çˆ¶ å…ƒç´ çš„ android:name å€¼ã€‚è¯·å‚é˜…ä¸‹é¢çš„ XML ç¤ºä¾‹ã€‚</p>
</li>
<li>
<p>åŒæ ·æ·»åŠ å¯¹ Android 4.1 åŠæ›´é«˜ç‰ˆæœ¬çš„æ”¯æŒã€‚ä¸ºæ­¤ï¼Œè¯·å°† android:parentActivityName å±æ€§æ·»åŠ åˆ°æ­£åœ¨å¯åŠ¨çš„ Activity çš„ å…ƒç´ ä¸­ã€‚</p>
<p>æœ€ç»ˆçš„ XML åº”å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;activity
</span></span><span class="line"><span class="cl">  android:name=&#34;.MainActivity&#34;
</span></span><span class="line"><span class="cl">  android:label=&#34;@string/app_name&#34; &gt;
</span></span><span class="line"><span class="cl">  &lt;intent-filter&gt;
</span></span><span class="line"><span class="cl">      &lt;action android:name=&#34;android.intent.action.MAIN&#34; /&gt;
</span></span><span class="line"><span class="cl">      &lt;category android:name=&#34;android.intent.category.LAUNCHER&#34; /&gt;
</span></span><span class="line"><span class="cl">  &lt;/intent-filter&gt;
</span></span><span class="line"><span class="cl">&lt;/activity&gt;
</span></span><span class="line"><span class="cl">&lt;activity
</span></span><span class="line"><span class="cl">  android:name=&#34;.ResultActivity&#34;
</span></span><span class="line"><span class="cl">  android:parentActivityName=&#34;.MainActivity&#34;&gt;
</span></span><span class="line"><span class="cl">  &lt;meta-data
</span></span><span class="line"><span class="cl">      android:name=&#34;android.support.PARENT_ACTIVITY&#34;
</span></span><span class="line"><span class="cl">      android:value=&#34;.MainActivity&#34;/&gt;
</span></span><span class="line"><span class="cl">&lt;/activity&gt;
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>æ ¹æ®å¯å¯åŠ¨ Activity çš„ Intent åˆ›å»ºè¿”å›æ ˆï¼š
<ul>
<li>
<p>åˆ›å»º Intent ä»¥å¯åŠ¨ Activityã€‚</p>
</li>
<li>
<p>é€šè¿‡è°ƒç”¨ TaskStackBuilder.create() åˆ›å»ºå †æ ˆç”Ÿæˆå™¨ã€‚</p>
</li>
<li>
<p>é€šè¿‡è°ƒç”¨ addParentStack() å°†è¿”å›æ ˆæ·»åŠ åˆ°å †æ ˆç”Ÿæˆå™¨ã€‚ å¯¹äºåœ¨æ¸…å•æ–‡ä»¶ä¸­æ‰€å®šä¹‰å±‚æ¬¡ç»“æ„å†…çš„æ¯ä¸ª Activityï¼Œè¿”å›æ ˆå‡åŒ…å«å¯å¯åŠ¨ Activity çš„ Intent å¯¹è±¡ã€‚æ­¤æ–¹æ³•è¿˜ä¼šæ·»åŠ ä¸€äº›å¯åœ¨å…¨æ–°ä»»åŠ¡ä¸­å¯åŠ¨å †æ ˆçš„æ ‡å¿—ã€‚</p>
<blockquote>
<p>æ³¨ï¼šå°½ç®¡ addParentStack() çš„å‚æ•°æ˜¯å¯¹å·²å¯åŠ¨ Activity çš„å¼•ç”¨ï¼Œä½†æ˜¯æ–¹æ³•è°ƒç”¨ä¸ä¼šæ·»åŠ å¯å¯åŠ¨ Activity çš„ Intentï¼Œè€Œæ˜¯ç•™å¾…ä¸‹ä¸€æ­¥è¿›è¡Œå¤„ç†ã€‚</p>
</blockquote>
</li>
<li>
<p>é€šè¿‡è°ƒç”¨ addNextIntent()ï¼Œæ·»åŠ å¯ä»é€šçŸ¥ä¸­å¯åŠ¨ Activity çš„ Intentã€‚ å°†åœ¨ç¬¬ä¸€æ­¥ä¸­åˆ›å»ºçš„ Intent ä½œä¸º addNextIntent() çš„å‚æ•°ä¼ é€’ã€‚</p>
</li>
<li>
<p>å¦‚éœ€ï¼Œè¯·é€šè¿‡è°ƒç”¨ TaskStackBuilder.editIntentAt() å‘å †æ ˆä¸­çš„ Intent å¯¹è±¡æ·»åŠ å‚æ•°ã€‚æœ‰æ—¶ï¼Œéœ€è¦ç¡®ä¿ç›®æ ‡ Activity åœ¨ç”¨æˆ·ä½¿ç”¨â€œè¿”å›â€å¯¼èˆªå›å®ƒæ—¶ä¼šæ˜¾ç¤ºæœ‰æ„ä¹‰çš„æ•°æ®ã€‚</p>
</li>
<li>
<p>é€šè¿‡è°ƒç”¨ getPendingIntent() è·å¾—æ­¤è¿”å›æ ˆçš„ PendingIntentã€‚ ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤ PendingIntent ä½œä¸º setContentIntent() çš„å‚æ•°ã€‚</p>
</li>
</ul>
</li>
</ol>
<p>ä»¥ä¸‹ä»£ç æ®µæ¼”ç¤ºäº†è¯¥æµç¨‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Intent</span><span class="w"> </span><span class="n">resultIntent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Intent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">ResultActivity</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">TaskStackBuilder</span><span class="w"> </span><span class="n">stackBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TaskStackBuilder</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Adds the back stack</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stackBuilder</span><span class="p">.</span><span class="na">addParentStack</span><span class="p">(</span><span class="n">ResultActivity</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Adds the Intent to the top of the stack</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stackBuilder</span><span class="p">.</span><span class="na">addNextIntent</span><span class="p">(</span><span class="n">resultIntent</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Gets a PendingIntent containing the entire back stack</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PendingIntent</span><span class="w"> </span><span class="n">resultPendingIntent</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">stackBuilder</span><span class="p">.</span><span class="na">getPendingIntent</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">PendingIntent</span><span class="p">.</span><span class="na">FLAG_UPDATE_CURRENT</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">builder</span><span class="p">.</span><span class="na">setContentIntent</span><span class="p">(</span><span class="n">resultPendingIntent</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">NotificationManager</span><span class="w"> </span><span class="n">mNotificationManager</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="n">NotificationManager</span><span class="p">)</span><span class="w"> </span><span class="n">getSystemService</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="na">NOTIFICATION_SERVICE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mNotificationManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è®¾ç½®ç‰¹æ®Š-activity-pendingintent">è®¾ç½®ç‰¹æ®Š Activity PendingIntent
</h3><p>ä¸‹æ–‡ä»‹ç»å¦‚ä½•è®¾ç½®ç‰¹æ®Š Activity PendingIntentã€‚</p>
<p>ç‰¹æ®Š Activity æ— éœ€è¿”å›æ ˆï¼Œå› æ­¤æ‚¨ä¸å¿…åœ¨æ¸…å•æ–‡ä»¶ä¸­å®šä¹‰å…¶ Activity å±‚æ¬¡ç»“æ„ï¼Œä¹Ÿä¸å¿…è°ƒç”¨ addParentStack() æ¥æ„å»ºè¿”å›æ ˆã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæ‚¨å¯ä½¿ç”¨æ¸…å•æ–‡ä»¶è®¾ç½® Activity ä»»åŠ¡é€‰é¡¹ï¼Œå¹¶é€šè¿‡è°ƒç”¨ getActivity() åˆ›å»º PendingIntentï¼š</p>
<ol>
<li>åœ¨æ¸…å•æ–‡ä»¶ä¸­ï¼Œå°†ä»¥ä¸‹å±æ€§æ·»åŠ åˆ° Activity çš„ å…ƒç´ 
<ul>
<li>
<p>android:name=&ldquo;activityclass&rdquo; Activity çš„å®Œå…¨é™å®šç±»åã€‚</p>
</li>
<li>
<p>android:taskAffinity=&quot;&quot; ä¸æ‚¨åœ¨ä»£ç ä¸­è®¾ç½®çš„ FLAG_ACTIVITY_NEW_TASK æ ‡å¿—ç›¸ç»“åˆï¼Œè¿™å¯ç¡®ä¿æ­¤ Activity ä¸ä¼šè¿›å…¥åº”ç”¨çš„é»˜è®¤ä»»åŠ¡ã€‚ä»»ä½•å…·æœ‰åº”ç”¨é»˜è®¤å…³è”çš„ç°æœ‰ä»»åŠ¡å‡ä¸å—å½±å“ã€‚</p>
</li>
<li>
<p>android:excludeFromRecents=&ldquo;true&rdquo; å°†æ–°ä»»åŠ¡ä»â€œæœ€æ–°åŠ¨æ€â€ä¸­æ’é™¤ï¼Œè¿™æ ·ç”¨æˆ·å°±ä¸ä¼šåœ¨æ— æ„ä¸­å¯¼èˆªå›å®ƒã€‚ ä»¥ä¸‹ä»£ç æ®µæ˜¾ç¤ºäº†è¯¥å…ƒç´ ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;activity
</span></span><span class="line"><span class="cl">  android:name=&#34;.ResultActivity&#34;
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">  android:launchMode=&#34;singleTask&#34;
</span></span><span class="line"><span class="cl">  android:taskAffinity=&#34;&#34;
</span></span><span class="line"><span class="cl">  android:excludeFromRecents=&#34;true&#34;&gt;
</span></span><span class="line"><span class="cl">&lt;/activity&gt;
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>æ„å»ºå¹¶å‘å‡ºé€šçŸ¥ï¼š
<ul>
<li>
<p>åˆ›å»ºå¯å¯åŠ¨ Activityçš„ Intentã€‚</p>
</li>
<li>
<p>é€šè¿‡ä½¿ç”¨ FLAG_ACTIVITY_NEW_TASK å’Œ FLAG_ACTIVITY_CLEAR_TASK æ ‡å¿—è°ƒç”¨ setFlags()ï¼Œå°† Activity è®¾ç½®ä¸ºåœ¨æ–°çš„ç©ºä»»åŠ¡ä¸­å¯åŠ¨ã€‚</p>
</li>
<li>
<p>ä¸º Intent è®¾ç½®æ‰€éœ€çš„ä»»ä½•å…¶ä»–é€‰é¡¹ã€‚</p>
</li>
<li>
<p>é€šè¿‡è°ƒç”¨ getActivity() ä» Intent ä¸­åˆ›å»º PendingIntentã€‚ ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤ PendingIntent ä½œä¸º setContentIntent() çš„å‚æ•°ã€‚ ä»¥ä¸‹ä»£ç æ®µæ¼”ç¤ºäº†è¯¥æµç¨‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// Instantiate a Builder object.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Creates an Intent for the Activity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Intent</span><span class="w"> </span><span class="n">notifyIntent</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">new</span><span class="w"> </span><span class="n">Intent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">ResultActivity</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Sets the Activity to start in a new, empty task</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">notifyIntent</span><span class="p">.</span><span class="na">setFlags</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="na">FLAG_ACTIVITY_NEW_TASK</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">|</span><span class="w"> </span><span class="n">Intent</span><span class="p">.</span><span class="na">FLAG_ACTIVITY_CLEAR_TASK</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Creates the PendingIntent</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PendingIntent</span><span class="w"> </span><span class="n">notifyPendingIntent</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">PendingIntent</span><span class="p">.</span><span class="na">getActivity</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">this</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">notifyIntent</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">PendingIntent</span><span class="p">.</span><span class="na">FLAG_UPDATE_CURRENT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Puts the PendingIntent into the notification builder</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">builder</span><span class="p">.</span><span class="na">setContentIntent</span><span class="p">(</span><span class="n">notifyPendingIntent</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Notifications are issued by sending them to the</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// NotificationManager system service.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">NotificationManager</span><span class="w"> </span><span class="n">mNotificationManager</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">(</span><span class="n">NotificationManager</span><span class="p">)</span><span class="w"> </span><span class="n">getSystemService</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="na">NOTIFICATION_SERVICE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Builds an anonymous Notification object from the builder, and</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// passes it to the NotificationManager</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mNotificationManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ol>
<h2 id="åœ¨é€šçŸ¥ä¸­æ˜¾ç¤ºè¿›åº¦">åœ¨é€šçŸ¥ä¸­æ˜¾ç¤ºè¿›åº¦
</h2><p>é€šçŸ¥å¯èƒ½åŒ…æ‹¬åŠ¨ç”»å½¢å¼çš„è¿›åº¦æŒ‡ç¤ºå™¨ï¼Œå‘ç”¨æˆ·æ˜¾ç¤ºæ­£åœ¨è¿›è¡Œçš„æ“ä½œçŠ¶æ€ã€‚ å¦‚æœæ‚¨å¯ä»¥ä¼°è®¡æ“ä½œæ‰€éœ€çš„æ—¶é—´ä»¥åŠä»»æ„æ—¶åˆ»çš„å®Œæˆè¿›åº¦ï¼Œåˆ™ä½¿ç”¨â€œé™å®šâ€å½¢å¼çš„æŒ‡ç¤ºå™¨ï¼ˆè¿›åº¦æ ï¼‰ã€‚ å¦‚æœæ— æ³•ä¼°è®¡æ“ä½œçš„æ—¶é•¿ï¼Œåˆ™ä½¿ç”¨â€œéé™å®šâ€å½¢å¼çš„æŒ‡ç¤ºå™¨ï¼ˆActivity æŒ‡ç¤ºå™¨ï¼‰ã€‚</p>
<p>å¹³å°çš„ ProgressBar ç±»å®ç°ä¸­æ˜¾ç¤ºæœ‰è¿›åº¦æŒ‡ç¤ºå™¨ã€‚</p>
<p>è¦åœ¨ Android 4.0 åŠæ›´é«˜ç‰ˆæœ¬çš„å¹³å°ä¸Šä½¿ç”¨è¿›åº¦æŒ‡ç¤ºå™¨ï¼Œéœ€è°ƒç”¨ setProgress()ã€‚å¯¹äºæ—©æœŸç‰ˆæœ¬ï¼Œæ‚¨å¿…é¡»åˆ›å»ºåŒ…æ‹¬ ProgressBar è§†å›¾çš„è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€ã€‚</p>
<p>ä¸‹æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ setProgress() åœ¨é€šçŸ¥ä¸­æ˜¾ç¤ºè¿›åº¦ã€‚</p>
<h3 id="æ˜¾ç¤ºæŒç»­æ—¶é—´å›ºå®šçš„è¿›åº¦æŒ‡ç¤ºå™¨">æ˜¾ç¤ºæŒç»­æ—¶é—´å›ºå®šçš„è¿›åº¦æŒ‡ç¤ºå™¨
</h3><p>è¦æ˜¾ç¤ºé™å®šå½¢å¼çš„è¿›åº¦æ ï¼Œè¯·é€šè¿‡è°ƒç”¨ setProgress(max, progress, false) å°†è¿›åº¦æ æ·»åŠ åˆ°é€šçŸ¥ï¼Œç„¶åå‘å‡ºé€šçŸ¥ã€‚éšç€æ“ä½œç»§ç»­è¿›è¡Œï¼Œé€’å¢ progress å¹¶æ›´æ–°é€šçŸ¥ã€‚æ“ä½œç»“æŸæ—¶ï¼Œ progress åº”è¯¥ç­‰äº maxã€‚è°ƒç”¨ setProgress() çš„å¸¸è§æ–¹æ³•æ˜¯å°† max è®¾ç½®ä¸º 100ï¼Œç„¶åå°† progress ä½œä¸ºæ“ä½œçš„â€œå®Œæˆç™¾åˆ†æ¯”â€å€¼é€’å¢ã€‚</p>
<p>æ‚¨å¯ä»¥åœ¨æ“ä½œå®Œæˆåä»ä¿ç•™æ˜¾ç¤ºè¿›åº¦æ ï¼Œä¹Ÿå¯ä»¥å°†å…¶åˆ é™¤ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œéƒ½è¯·è®°ä½æ›´æ–°é€šçŸ¥æ–‡æœ¬ä»¥æ˜¾ç¤ºæ“ä½œå·²å®Œæˆã€‚ è¦åˆ é™¤è¿›åº¦æ ï¼Œè¯·è°ƒç”¨ setProgress(0, 0, false)ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mNotifyManager</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">(</span><span class="n">NotificationManager</span><span class="p">)</span><span class="w"> </span><span class="n">getSystemService</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="na">NOTIFICATION_SERVICE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NotificationCompat</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mBuilder</span><span class="p">.</span><span class="na">setContentTitle</span><span class="p">(</span><span class="s">&#34;Picture Download&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setContentText</span><span class="p">(</span><span class="s">&#34;Download in progress&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setSmallIcon</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">ic_notification</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Start a lengthy operation in a background thread</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">Runnable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">incr</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Do the &#34;lengthy&#34; operation 20 times</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">incr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">incr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">100</span><span class="p">;</span><span class="w"> </span><span class="n">incr</span><span class="o">+=</span><span class="n">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// Sets the progress indicator to a max value, the</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// current completion percentage, and &#34;determinate&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// state</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">mBuilder</span><span class="p">.</span><span class="na">setProgress</span><span class="p">(</span><span class="n">100</span><span class="p">,</span><span class="w"> </span><span class="n">incr</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// Displays the progress bar for the first time.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">mNotifyManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">mBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">// Sleeps the thread, simulating an operation</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">// that takes time</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                            </span><span class="c1">// Sleep for 5 seconds</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">5</span><span class="o">*</span><span class="n">1000</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                            </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;sleep failure&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// When the loop is finished, updates the notification</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">mBuilder</span><span class="p">.</span><span class="na">setContentText</span><span class="p">(</span><span class="s">&#34;Download complete&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Removes the progress bar</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="p">.</span><span class="na">setProgress</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="n">0</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">mNotifyManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">mBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Starts the thread by calling the run() method in its Runnable</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ˜¾ç¤ºæŒç»­-activity-æŒ‡ç¤ºå™¨">æ˜¾ç¤ºæŒç»­ Activity æŒ‡ç¤ºå™¨
</h3><p>è¦æ˜¾ç¤ºéé™å®šå½¢å¼çš„ Activity æŒ‡ç¤ºå™¨ï¼Œè¯·ä½¿ç”¨ setProgress(0, 0, true) å°†å…¶æ·»åŠ åˆ°é€šçŸ¥ï¼ˆå¿½ç•¥å‰ä¸¤ä¸ªå‚æ•°ï¼‰ï¼Œç„¶åå‘å‡ºé€šçŸ¥ã€‚è¿™æ ·ä¸€æ¥ï¼ŒæŒ‡ç¤ºå™¨çš„æ ·å¼å°±ä¸è¿›åº¦æ ç›¸åŒï¼Œåªæ˜¯å…¶åŠ¨ç”»è¿˜åœ¨ç»§ç»­ã€‚</p>
<p>åœ¨æ“ä½œå¼€å§‹ä¹‹é™…å‘å‡ºé€šçŸ¥ã€‚é™¤éæ‚¨ä¿®æ”¹é€šçŸ¥ï¼Œå¦åˆ™åŠ¨ç”»å°†ä¸€ç›´è¿è¡Œã€‚ æ“ä½œå®Œæˆåï¼Œè°ƒç”¨ setProgress(0, 0, false)ï¼Œç„¶åæ›´æ–°é€šçŸ¥ä»¥åˆ é™¤ Activity æŒ‡ç¤ºå™¨ã€‚ è¯·åŠ¡å¿…è¿™æ ·åšï¼›å¦åˆ™ï¼Œå³ä½¿æ“ä½œå®Œæˆï¼ŒåŠ¨ç”»ä»å°†è¿è¡Œã€‚åŒæ—¶ï¼Œè¯·è®°å¾—æ›´æ”¹é€šçŸ¥æ–‡æœ¬ï¼Œä»¥è¡¨æ˜æ“ä½œå·²å®Œæˆã€‚</p>
<p>è¦äº†è§£ Activity æŒ‡ç¤ºå™¨çš„å·¥ä½œæ–¹å¼ï¼Œè¯·å‚é˜…ä¸Šè¿°ä»£ç æ®µã€‚æ‰¾åˆ°ä»¥ä¸‹å‡ è¡Œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// Sets the progress indicator to a max value, the current completion</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// percentage, and &#34;determinate&#34; state</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mBuilder</span><span class="p">.</span><span class="na">setProgress</span><span class="p">(</span><span class="n">100</span><span class="p">,</span><span class="w"> </span><span class="n">incr</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Issues the notification</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mNotifyManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">mBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å°†æ‰¾åˆ°çš„è¿™å‡ è¡Œæ›¿æ¢ä¸ºä»¥ä¸‹å‡ è¡Œ</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="c1">// Sets an activity indicator for an operation of indeterminate length</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mBuilder</span><span class="p">.</span><span class="na">setProgress</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Issues the notification</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mNotifyManager</span><span class="p">.</span><span class="na">notify</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">mBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="é€šçŸ¥å…ƒæ•°æ®">é€šçŸ¥å…ƒæ•°æ®
</h2><p>é€šçŸ¥å¯æ ¹æ®æ‚¨ä½¿ç”¨ä»¥ä¸‹ NotificationCompat.Builder æ–¹æ³•åˆ†é…çš„å…ƒæ•°æ®è¿›è¡Œæ’åºï¼š</p>
<p>å½“è®¾å¤‡å¤„äºâ€œä¼˜å…ˆâ€æ¨¡å¼æ—¶ï¼ŒsetCategory() ä¼šå‘ŠçŸ¥ç³»ç»Ÿå¦‚ä½•å¤„ç†åº”ç”¨é€šçŸ¥ï¼ˆä¾‹å¦‚ï¼Œé€šçŸ¥ä»£è¡¨ä¼ å…¥å‘¼å«ã€å³æ—¶æ¶ˆæ¯è¿˜æ˜¯é—¹é“ƒï¼‰ã€‚ å¦‚æœä¼˜å…ˆçº§å­—æ®µè®¾ç½®ä¸º PRIORITY_MAX æˆ– PRIORITY_HIGH çš„é€šçŸ¥è¿˜æœ‰å£°éŸ³æˆ–æŒ¯åŠ¨ï¼Œåˆ™ setPriority() ä¼šå°†å…¶æ˜¾ç¤ºåœ¨å°å‹æµ®åŠ¨çª—å£ä¸­ã€‚ addPerson() å…è®¸æ‚¨å‘é€šçŸ¥æ·»åŠ äººå‘˜åå•ã€‚æ‚¨çš„åº”ç”¨å¯ä»¥ä½¿ç”¨æ­¤åå•æŒ‡ç¤ºç³»ç»Ÿå°†æŒ‡å®šäººå‘˜å‘å‡ºçš„é€šçŸ¥å½’æˆä¸€ç»„ï¼Œæˆ–è€…å°†è¿™äº›äººå‘˜å‘å‡ºçš„é€šçŸ¥è§†ä¸ºæ›´é‡è¦çš„é€šçŸ¥ã€‚</p>
<h2 id="æµ®åŠ¨é€šçŸ¥">æµ®åŠ¨é€šçŸ¥
</h2><p>å¯¹äº Android 5.0ï¼ˆAPI çº§åˆ« 21ï¼‰ï¼Œå½“è®¾å¤‡å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼ˆå³ï¼Œè®¾å¤‡æœªé”å®šä¸”å…¶å±å¹•å·²æ‰“å¼€ï¼‰ï¼Œé€šçŸ¥å¯ä»¥æ˜¾ç¤ºåœ¨å°å‹æµ®åŠ¨çª—å£ä¸­ï¼ˆä¹Ÿç§°ä¸ºâ€œæµ®åŠ¨é€šçŸ¥â€ï¼‰ã€‚ è¿™äº›é€šçŸ¥çœ‹ä¸Šå»ç±»ä¼¼äºç²¾ç®€ç‰ˆçš„é€šçŸ¥â€‹â€‹ï¼Œåªæ˜¯æµ®åŠ¨é€šçŸ¥è¿˜æ˜¾ç¤ºæ“ä½œæŒ‰é’®ã€‚ ç”¨æˆ·å¯ä»¥åœ¨ä¸ç¦»å¼€å½“å‰åº”ç”¨çš„æƒ…å†µä¸‹å¤„ç†æˆ–æ¸…é™¤æµ®åŠ¨é€šçŸ¥ã€‚</p>
<p><img src="/.gitbook/assets/heads-up%20%282%29%20%282%29%20%282%29%20%282%29%20%282%29%20%282%29%20%282%29%20%281%29.png"
	
	
	
	loading="lazy"
	
		alt="å›¾ 3. æ˜¾ç¤ºæµ®åŠ¨é€šçŸ¥çš„å…¨å± Activity"
	
	
></p>
<p>å¯èƒ½è§¦å‘æµ®åŠ¨é€šçŸ¥çš„æ¡ä»¶ç¤ºä¾‹åŒ…æ‹¬ï¼š</p>
<ul>
<li>ç”¨æˆ·çš„ Activity å¤„äºå…¨å±æ¨¡å¼ä¸­ï¼ˆåº”ç”¨ä½¿ç”¨ fullScreenIntentï¼‰ï¼Œæˆ–è€…</li>
<li>é€šçŸ¥å…·æœ‰è¾ƒé«˜çš„ä¼˜å…ˆçº§å¹¶ä½¿ç”¨é“ƒå£°æˆ–æŒ¯åŠ¨</li>
</ul>
<h2 id="é”å®šå±å¹•é€šçŸ¥">é”å®šå±å¹•é€šçŸ¥
</h2><p>éšç€ Android 5.0ï¼ˆAPI çº§åˆ« 21ï¼‰çš„å‘å¸ƒï¼Œé€šçŸ¥ç°åœ¨è¿˜å¯æ˜¾ç¤ºåœ¨é”å®šå±å¹•ä¸Šã€‚æ‚¨çš„åº”ç”¨å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½æä¾›åª’ä½“æ’­æ”¾æ§ä»¶ä»¥åŠå…¶ä»–å¸¸ç”¨æ“ä½œã€‚ ç”¨æˆ·å¯ä»¥é€šè¿‡â€œè®¾ç½®â€é€‰æ‹©æ˜¯å¦å°†é€šçŸ¥æ˜¾ç¤ºåœ¨é”å®šå±å¹•ä¸Šï¼Œå¹¶ä¸”æ‚¨å¯ä»¥æŒ‡å®šæ‚¨åº”ç”¨ä¸­çš„é€šçŸ¥åœ¨é”å®šå±å¹•ä¸Šæ˜¯å¦å¯è§ã€‚</p>
<h2 id="è®¾ç½®å¯è§æ€§">è®¾ç½®å¯è§æ€§
</h2><p>æ‚¨çš„åº”ç”¨å¯ä»¥æ§åˆ¶åœ¨å®‰å…¨é”å®šå±å¹•ä¸Šæ˜¾ç¤ºçš„é€šçŸ¥ä¸­å¯è§çš„è¯¦ç»†çº§åˆ«ã€‚ è°ƒç”¨ setVisibility() å¹¶æŒ‡å®šä»¥ä¸‹å€¼ä¹‹ä¸€ï¼š</p>
<ul>
<li>VISIBILITY_PUBLIC æ˜¾ç¤ºé€šçŸ¥çš„å®Œæ•´å†…å®¹ã€‚</li>
<li>VISIBILITY_SECRET ä¸ä¼šåœ¨é”å®šå±å¹•ä¸Šæ˜¾ç¤ºæ­¤é€šçŸ¥çš„ä»»ä½•éƒ¨åˆ†ã€‚</li>
<li>VISIBILITY_PRIVATE æ˜¾ç¤ºé€šçŸ¥å›¾æ ‡å’Œå†…å®¹æ ‡é¢˜ç­‰åŸºæœ¬ä¿¡æ¯ï¼Œä½†æ˜¯éšè—é€šçŸ¥çš„å®Œæ•´å†…å®¹ã€‚</li>
</ul>
<p>è®¾ç½® VISIBILITY_PRIVATE åï¼Œæ‚¨è¿˜å¯ä»¥æä¾›å…¶ä¸­éšè—äº†æŸäº›è¯¦ç»†ä¿¡æ¯çš„æ›¿æ¢ç‰ˆæœ¬é€šçŸ¥å†…å®¹ã€‚ä¾‹å¦‚ï¼ŒçŸ­ä¿¡ åº”ç”¨å¯èƒ½ä¼šæ˜¾ç¤ºä¸€æ¡é€šçŸ¥ï¼ŒæŒ‡å‡ºâ€œæ‚¨æœ‰ 3 æ¡æ–°çŸ­ä¿¡â€ï¼Œä½†æ˜¯éšè—äº†çŸ­ä¿¡å†…å®¹å’Œå‘ä»¶äººã€‚è¦æä¾›æ­¤æ›¿æ¢ç‰ˆæœ¬çš„é€šçŸ¥ï¼Œè¯·å…ˆä½¿ç”¨ NotificationCompat.Builder åˆ›å»ºæ›¿æ¢é€šçŸ¥ã€‚åˆ›å»ºä¸“ç”¨é€šçŸ¥å¯¹è±¡æ—¶ï¼Œè¯·é€šè¿‡ setPublicVersion() æ–¹æ³•ä¸ºå…¶é™„åŠ æ›¿æ¢é€šçŸ¥ã€‚</p>
<h2 id="åœ¨é”å®šå±å¹•ä¸Šæ§åˆ¶åª’ä½“æ’­æ”¾">åœ¨é”å®šå±å¹•ä¸Šæ§åˆ¶åª’ä½“æ’­æ”¾
</h2><p>åœ¨ Android 5.0ï¼ˆAPI çº§åˆ« 21ï¼‰ä¸­ï¼Œé”å®šå±å¹•ä¸å†åŸºäº RemoteControlClientï¼ˆç°å·²å¼ƒç”¨ï¼‰æ˜¾ç¤ºåª’ä½“æ§ä»¶ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå°† Notification.MediaStyle æ¨¡æ¿ä¸ addAction() æ–¹æ³•ç»“åˆä½¿ç”¨ï¼Œåè€…å¯å°†æ“ä½œè½¬æ¢ä¸ºå¯ç‚¹å‡»çš„å›¾æ ‡ã€‚</p>
<blockquote>
<p>æ³¨ï¼šè¯¥æ¨¡æ¿å’Œ addAction() æ–¹æ³•æœªåŒ…å«åœ¨æ”¯æŒåº“ä¸­ï¼Œå› æ­¤è¿™äº›åŠŸèƒ½åªèƒ½åœ¨ Android 5.0 åŠæ›´é«˜ç‰ˆæœ¬çš„ç³»ç»Ÿä¸Šè¿è¡Œã€‚</p>
</blockquote>
<p>è¦åœ¨ Android 5.0 ç³»ç»Ÿçš„é”å®šå±å¹•ä¸Šæ˜¾ç¤ºåª’ä½“æ’­æ”¾æ§ä»¶ï¼Œè¯·å°†å¯è§æ€§è®¾ç½®ä¸º VISIBILITY_PUBLICï¼Œå¦‚ä¸Šæ–‡æ‰€è¿°ã€‚ç„¶åï¼Œæ·»åŠ æ“ä½œå¹¶è®¾ç½® Notification.MediaStyle æ¨¡æ¿ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹ä»£ç ä¸­æ‰€è¿°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Notification</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Notification</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Show controls on lock screen even when user hides sensitive content.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setVisibility</span><span class="p">(</span><span class="n">Notification</span><span class="p">.</span><span class="na">VISIBILITY_PUBLIC</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setSmallIcon</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">ic_stat_player</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Add media control buttons that invoke intents in your media service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">addAction</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">ic_prev</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Previous&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">prevPendingIntent</span><span class="p">)</span><span class="w"> </span><span class="c1">// #0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">addAction</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">ic_pause</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Pause&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">pausePendingIntent</span><span class="p">)</span><span class="w">  </span><span class="c1">// #1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">addAction</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">ic_next</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Next&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">nextPendingIntent</span><span class="p">)</span><span class="w">     </span><span class="c1">// #2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Apply the media style template</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setStyle</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Notification</span><span class="p">.</span><span class="na">MediaStyle</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setShowActionsInCompactView</span><span class="p">(</span><span class="n">1</span><span class="w"> </span><span class="cm">/* #1: pause button */</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setMediaSession</span><span class="p">(</span><span class="n">mMediaSession</span><span class="p">.</span><span class="na">getSessionToken</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setContentTitle</span><span class="p">(</span><span class="s">&#34;Wonderful music&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setContentText</span><span class="p">(</span><span class="s">&#34;My Awesome Band&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">setLargeIcon</span><span class="p">(</span><span class="n">albumArtBitmap</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨ï¼šå¼ƒç”¨ RemoteControlClient ä¼šå¯¹æ§åˆ¶åª’ä½“äº§ç”Ÿè¿›ä¸€æ­¥çš„å½±å“ã€‚å¦‚éœ€äº†è§£æœ‰å…³ç”¨äºç®¡ç†åª’ä½“ä¼šè¯å’Œæ§åˆ¶æ’­æ”¾çš„æ–° API çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…åª’ä½“æ’­æ”¾æ§ä»¶ã€‚</p>
</blockquote>
<h2 id="è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€">è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€
</h2><p>æ‚¨å¯ä»¥åˆ©ç”¨é€šçŸ¥æ¡†æ¶å®šä¹‰è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€ï¼Œç”±è¯¥å¸ƒå±€å®šä¹‰é€šçŸ¥åœ¨ RemoteViews å¯¹è±¡ä¸­çš„å¤–è§‚ã€‚ è‡ªå®šä¹‰å¸ƒå±€é€šçŸ¥ç±»ä¼¼äºå¸¸è§„é€šçŸ¥ï¼Œä½†æ˜¯å®ƒä»¬æ˜¯åŸºäº XML å¸ƒå±€æ–‡ä»¶ä¸­æ‰€å®šä¹‰çš„ RemoteViewsã€‚</p>
<p>è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€çš„å¯ç”¨é«˜åº¦å–å†³äºé€šçŸ¥è§†å›¾ã€‚æ™®é€šè§†å›¾å¸ƒå±€é™åˆ¶ä¸º 64 dpï¼Œæ‰©å±•è§†å›¾å¸ƒå±€é™åˆ¶ä¸º 256 dpã€‚</p>
<p>è¦å®šä¹‰è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€ï¼Œè¯·é¦–å…ˆå®ä¾‹åŒ– RemoteViews å¯¹è±¡æ¥æ‰©å…… XML å¸ƒå±€æ–‡ä»¶ã€‚ç„¶åï¼Œè°ƒç”¨ setContent()ï¼Œè€Œä¸æ˜¯è°ƒç”¨ setContentTitle() ç­‰æ–¹æ³•ã€‚è¦åœ¨è‡ªå®šä¹‰é€šçŸ¥ä¸­è®¾ç½®å†…å®¹è¯¦ç»†ä¿¡æ¯ï¼Œè¯·ä½¿ç”¨ RemoteViews ä¸­çš„æ–¹æ³•è®¾ç½®è§†å›¾å­é¡¹çš„å€¼ï¼š</p>
<p>åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ä¸ºé€šçŸ¥åˆ›å»º XML å¸ƒå±€ã€‚æ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨ä»»ä½•æ–‡ä»¶åï¼Œä½†å¿…é¡»ä½¿ç”¨æ‰©å±•å .xmlã€‚ åœ¨æ‚¨çš„åº”ç”¨ä¸­ï¼Œä½¿ç”¨ RemoteViews æ–¹æ³•å®šä¹‰é€šçŸ¥çš„å›¾æ ‡å’Œæ–‡æœ¬ã€‚é€šè¿‡è°ƒç”¨ setContent() å°†æ­¤ RemoteViews å¯¹è±¡æ”¾å…¥ NotificationCompat.Builder ä¸­ã€‚é¿å…åœ¨ RemoteViews å¯¹è±¡ä¸Šè®¾ç½®èƒŒæ™¯ Drawableï¼Œå› ä¸ºæ–‡æœ¬é¢œè‰²å¯èƒ½ä½¿æ–‡æœ¬å˜å¾—éš¾ä»¥é˜…è¯»ã€‚ æ­¤å¤–ï¼ŒRemoteViews ç±»ä¸­è¿˜æœ‰ä¸€äº›æ–¹æ³•å¯ä¾›æ‚¨è½»æ¾å°† Chronometer æˆ– ProgressBar æ·»åŠ åˆ°é€šçŸ¥å¸ƒå±€ã€‚å¦‚éœ€äº†è§£æœ‰å…³ä¸ºé€šçŸ¥åˆ›å»ºè‡ªå®šä¹‰å¸ƒå±€çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… RemoteViews å‚è€ƒæ–‡æ¡£ã€‚</p>
<p>æ³¨æ„ï¼šä½¿ç”¨è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€æ—¶ï¼Œè¦ç‰¹åˆ«æ³¨æ„ç¡®ä¿è‡ªå®šä¹‰å¸ƒå±€é€‚ç”¨äºä¸åŒçš„è®¾å¤‡æ–¹å‘å’Œåˆ†è¾¨ç‡ã€‚ å°½ç®¡è¿™æ¡å»ºè®®é€‚ç”¨äºæ‰€æœ‰â€œè§†å›¾â€å¸ƒå±€ï¼Œä½†å¯¹é€šçŸ¥å°¤ä¸ºé‡è¦ï¼Œå› ä¸ºæŠ½å±‰å¼é€šçŸ¥æ ä¸­çš„ç©ºé—´éå¸¸æœ‰é™ã€‚ ä¸è¦è®©è‡ªå®šä¹‰å¸ƒå±€è¿‡äºå¤æ‚ï¼ŒåŒæ—¶ç¡®ä¿åœ¨å„ç§é…ç½®ä¸­å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚</p>
<h3 id="å¯¹è‡ªå®šä¹‰é€šçŸ¥æ–‡æœ¬ä½¿ç”¨æ ·å¼èµ„æº">å¯¹è‡ªå®šä¹‰é€šçŸ¥æ–‡æœ¬ä½¿ç”¨æ ·å¼èµ„æº
</h3><p>å§‹ç»ˆå¯¹è‡ªå®šä¹‰é€šçŸ¥çš„æ–‡æœ¬ä½¿ç”¨æ ·å¼èµ„æºã€‚é€šçŸ¥çš„èƒŒæ™¯é¢œè‰²å¯èƒ½å› è®¾å¤‡å’Œç³»ç»Ÿç‰ˆæœ¬çš„ä¸åŒè€Œå¼‚ï¼Œä½¿ç”¨æ ·å¼èµ„æºæœ‰åŠ©äºæ‚¨å……åˆ†è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ã€‚ ä» Android 2.3 å¼€å§‹ï¼Œç³»ç»Ÿå®šä¹‰äº†æ ‡å‡†é€šçŸ¥å¸ƒå±€æ–‡æœ¬çš„æ ·å¼ã€‚è‹¥è¦åœ¨é¢å‘ Android 2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ç³»ç»Ÿçš„å¤šä¸ªåº”ç”¨ä¸­ä½¿ç”¨ç›¸åŒæ ·å¼ï¼Œåˆ™åº”ç¡®ä¿æ–‡æœ¬åœ¨æ˜¾ç¤ºèƒŒæ™¯ä¸Šå¯è§ã€‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ
</h2><ul>
<li><a class="link" href="https://developer.android.com/guide/topics/ui/notifiers/notifications.html"  target="_blank" rel="noopener"
    >é€šçŸ¥</a></li>
<li><a class="link" href="http://blog.csdn.net/w804518214/article/details/51231946"  target="_blank" rel="noopener"
    >Android Notificationå¸¸è§æ ·å¼æ€»ç»“</a></li>
</ul>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="malinkang/malinkang"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzMTUwNzEyODU="
    data-category="General"
    data-category-id="DIC_kwDOEsebNc4CbSPg"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2013 - 
        
        2024 malinkang
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<script>
    var s1 = '2014-01-01';
    s1 = new Date(s1.replace(/-/g, "/"));
    s2 = new Date();
    var days = s2.getTime() - s1.getTime();
    var number_of_days = parseInt(days / (1000 * 60 * 60 * 24));
    document.getElementById('days').innerHTML = number_of_days;
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
